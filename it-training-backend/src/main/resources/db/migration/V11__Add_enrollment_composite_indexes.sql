-- ============================================================================
-- Flyway 迁移脚本 V11: 添加enrollment表复合索引
-- 描述: 优化enrollment表查询性能，添加额外复合索引
-- 作者: IT Training System Team
-- 日期: 2025-12-24
-- ============================================================================

-- ============================================================================
-- 报名表额外复合索引
-- ============================================================================

-- 按班期和状态查询报名（讲师查看班期学员列表）
CREATE INDEX `idx_session_status` ON `enrollment` (`session_id`, `status`);

-- 按报名时间和状态查询（统计趋势分析）
CREATE INDEX `idx_enrolled_at_status` ON `enrollment` (`enrolled_at`, `status`);

-- ============================================================================
-- 性能说明
-- ============================================================================
-- 1. idx_session_status: 优化讲师端查看班期学员列表的查询性能
-- 2. idx_enrolled_at_status: 优化按时间范围统计报名数量的查询性能
-- 3. 配合已有的 idx_user_status_enrolled 索引，覆盖主要查询场景
-- ============================================================================
