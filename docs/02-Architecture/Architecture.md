# IT 技能培训智能选课系统 - 架构设计文档

> 文档版本：v1.1.0
> 最后更新：2025-12-24
> 文档状态：✅ 已完成
> 关联文档：[PRD.md](../01-Requirements/PRD.md) | [BusinessRules.md](../01-Requirements/BusinessRules.md)

---

## 目录

1. [架构概览](#1-架构概览)
2. [技术选型](#2-技术选型)
3. [模块设计](#3-模块设计)
4. [权限设计](#4-权限设计)
5. [关键流程](#5-关键流程)
6. [部署架构](#6-部署架构)
7. [参考风格说明](#7-参考风格说明)

---

## 1. 架构概览

### 1.1 系统架构图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              客户端层 (Client)                               │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│    ┌──────────────┐    ┌──────────────┐    ┌──────────────┐                │
│    │   管理端      │    │   讲师端      │    │   学员端      │                │
│    │  (Admin)     │    │ (Instructor) │    │  (Student)   │                │
│    │              │    │              │    │              │                │
│    │ • 用户管理   │    │ • 我的班期   │    │ • 课程浏览   │                │
│    │ • 课程管理   │    │ • 学员名单   │    │ • 在线报名   │                │
│    │ • 班期管理   │    │              │    │ • 我的报名   │                │
│    │ • 报名管理   │    │              │    │ • AI 推荐    │                │
│    │ • 统计看板   │    │              │    │ • 学习中心   │                │
│    │             │    │              │    │ • 个人中心   │                │
│    └──────┬───────┘    └──────┬───────┘    └──────┬───────┘                │
│           │                   │                   │                        │
│           └───────────────────┼───────────────────┘                        │
│                               │                                            │
│                               ▼                                            │
│    ┌─────────────────────────────────────────────────────────────────┐    │
│    │              Vue 3.5 + Element Plus + PrimeVue                   │    │
│    │         (Vite 7.x + Pinia 3.x + Vue Router + Axios)             │    │
│    └─────────────────────────────────────────────────────────────────┘    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    │ HTTP/HTTPS (RESTful API)
                                    │ JWT Token
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              网关层 (Gateway)                                │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│    ┌─────────────────────────────────────────────────────────────────┐    │
│    │                      Nginx (可选)                                │    │
│    │            静态资源 + 反向代理 + 负载均衡                         │    │
│    └─────────────────────────────────────────────────────────────────┘    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              应用层 (Application)                            │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│    ┌─────────────────────────────────────────────────────────────────┐    │
│    │                   Spring Boot 3.2.5 Application                  │    │
│    ├─────────────────────────────────────────────────────────────────┤    │
│    │                                                                  │    │
│    │  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────┐│    │
│    │  │   Auth     │  │   User     │  │  Course    │  │  Session   ││    │
│    │  │  Module    │  │  Module    │  │  Module    │  │  Module    ││    │
│    │  │            │  │            │  │            │  │            ││    │
│    │  │ • 登录     │  │ • CRUD     │  │ • CRUD     │  │ • CRUD     ││    │
│    │  │ • 注册     │  │ • 权限     │  │ • 上下架   │  │ • 状态     ││    │
│    │  │ • JWT      │  │ • 个人中心 │  │ • 章节     │  │            ││    │
│    │  └────────────┘  └────────────┘  └────────────┘  └────────────┘│    │
│    │                                                                  │    │
│    │  ┌────────────┐  ┌────────────┐  ┌────────────┐  ┌────────────┐│    │
│    │  │ Enrollment │  │    AI      │  │  Learning  │  │ Statistics ││    │
│    │  │  Module    │  │  Module    │  │  Module    │  │  Module    ││    │
│    │  │            │  │            │  │            │  │            ││    │
│    │  │ • 报名     │  │ • 推荐     │  │ • 进度     │  │ • 概览     ││    │
│    │  │ • 取消     │  │ • 降级     │  │ • 计划     │  │ • 图表     ││    │
│    │  │ • 名额     │  │ • 日志     │  │ • 打卡     │  │            ││    │
│    │  │            │  │ • 混合推荐 │  │ • 成就     │  │            ││    │
│    │  └────────────┘  └────────────┘  └────────────┘  └────────────┘│    │
│    │                                                                  │    │
│    │  ┌────────────┐  ┌────────────┐                                │    │
│    │  │ Student    │  │Notification│                                │    │
│    │  │  Module    │  │  Module    │                                │    │
│    │  │            │  │            │                                │    │
│    │  │ • 仪表盘   │  │ • 系统通知 │                                │    │
│    │  │ • 章节进度 │  │ • 学习提醒 │                                │    │
│    │  │ • 学习连续 │  │            │                                │    │
│    │  │ • 用户等级 │  │            │                                │    │
│    │  └────────────┘  └────────────┘                                │    │
│    │                                                                  │    │
│    ├─────────────────────────────────────────────────────────────────┤    │
│    │                        公共组件                                  │    │
│    │  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐           │    │
│    │  │ Security │ │ Exception│ │  Utils   │ │  Config  │           │    │
│    │  │  (JWT)   │ │ Handler  │ │          │ │          │           │    │
│    │  └──────────┘ └──────────┘ └──────────┘ └──────────┘           │    │
│    │                                                                  │    │
│    └─────────────────────────────────────────────────────────────────┘    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
                                    │
                    ┌───────────────┼───────────────┐
                    │               │               │
                    ▼               ▼               ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              数据层 (Data)                                   │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│    ┌──────────────┐    ┌──────────────┐    ┌──────────────┐                │
│    │    MySQL     │    │    Redis     │    │   AI API     │                │
│    │     8.0      │    │   (可选)     │    │  (Spring AI) │                │
│    │              │    │              │    │              │                │
│    │ • sys_user   │    │ • 会话缓存   │    │ • OpenAI     │                │
│    │ • course     │    │ • 名额预扣   │    │ • 其他模型   │                │
│    │ • class_     │    │   (二期)     │    │              │                │
│    │   session    │    │              │    │              │                │
│    │ • enrollment │    │              │    │              │                │
│    │ • learning_* │    │              │    │              │                │
│    │ • ai_log     │    │              │    │              │                │
│    └──────────────┘    └──────────────┘    └──────────────┘                │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.2 分层说明

| 层级 | 职责 | 技术 |
|------|------|------|
| 客户端层 | 用户界面、交互逻辑 | Vue 3.5 + Element Plus + PrimeVue |
| 网关层 | 静态资源、反向代理 | Nginx（可选） |
| 应用层 | 业务逻辑、API 服务 | Spring Boot 3.2.5 |
| 数据层 | 数据持久化、外部服务 | MySQL + Redis(可选) + AI API |

---

## 2. 技术选型

### 2.1 后端技术栈

| 技术 | 版本 | 用途 | 选型理由 |
|------|------|------|----------|
| Java | 17 | 开发语言 | LTS 版本，Spring Boot 3.x 要求 |
| Spring Boot | 3.2.5 | 应用框架 | 主流企业级框架，生态完善 |
| Spring Security | 6.x | 安全框架 | 认证授权一体化 |
| JWT (jjwt) | 0.12.5 | Token 认证 | 无状态，易于扩展 |
| MyBatis-Plus | 3.5.5 | ORM 框架 | 简化 CRUD，代码生成 |
| MySQL | 8.0 | 关系数据库 | 成熟稳定，社区活跃 |
| Spring AI | 1.0.0-M4 | AI 集成 | Spring 官方 AI 抽象层 |
| Lombok | 1.18.x | 代码简化 | 减少样板代码 |
| Validation | - | 参数校验 | JSR-303 标准 |
| SpringDoc | 2.3.0 | 接口文档 | 自动生成 OpenAPI 文档 |

### 2.2 前端技术栈

| 技术 | 版本 | 用途 | 选型理由 |
|------|------|------|----------|
| Vue | 3.5.24 | 前端框架 | 渐进式，学习曲线平缓 |
| Vite | 7.2.4 | 构建工具 | 快速冷启动，HMR |
| Pinia | 3.0.4 | 状态管理 | Vue 3 官方推荐 |
| Vue Router | 4.x | 路由管理 | SPA 路由 |
| Element Plus | 2.12 | UI 组件库 | 企业级组件，文档完善 |
| PrimeVue | 4.5.4 | UI 组件库 | 丰富组件，现代设计 |
| Axios | 1.x | HTTP 客户端 | Promise 风格，拦截器 |
| ECharts | 6.x | 图表库 | 丰富图表类型 |
| TailwindCSS | 3.x | CSS 框架 | 原子化 CSS |

### 2.3 开发与部署

| 技术 | 用途 |
|------|------|
| Git | 版本控制 |
| Docker | 容器化部署 |
| Docker Compose | 多容器编排 |
| Maven | 后端构建 |
| pnpm | 前端包管理 |

---

## 3. 模块设计

### 3.1 后端模块结构

```
it-training-backend/
├── src/main/java/com/itts/
│   ├── ItTrainingApplication.java           # 启动类
│   │
│   ├── common/                              # 公共模块
│   │   ├── ai/                              # AI 服务抽象
│   │   ├── config/                          # 配置类
│   │   ├── security/                        # 安全相关
│   │   ├── exception/                       # 异常处理
│   │   ├── response/                        # 统一响应
│   │   └── util/                            # 工具类
│   │
│   ├── modules/                             # 业务模块
│   │   ├── auth/                            # 认证模块
│   │   ├── user/                            # 用户模块
│   │   ├── course/                          # 课程模块
│   │   ├── session/                         # 班期模块
│   │   ├── enrollment/                      # 报名模块
│   │   ├── ai/                              # AI 推荐模块
│   │   ├── learning/                        # 学习管理模块
│   │   ├── student/                         # 学员专属模块
│   │   ├── notification/                    # 通知模块
│   │   └── stats/                           # 统计模块
│   │
│   └── enums/                               # 枚举定义
│
└── src/main/resources/
    ├── application.yml                      # 主配置
    └── mapper/                              # MyBatis XML
```

### 3.2 前端模块结构

```
it-training-frontend/
├── src/
│   ├── api/                                 # API 接口
│   ├── components/                          # 公共组件
│   ├── design-system/                       # 设计系统
│   ├── views/                               # 页面组件
│   ├── router/                              # 路由配置
│   ├── stores/                              # 状态管理
│   ├── utils/                               # 工具函数
│   └── types/                               # 类型定义
└── package.json
```

### 3.3 模块依赖关系

```
依赖说明：
• Auth 依赖 User（获取用户信息）
• Session 依赖 Course、User（关联课程和讲师）
• Enrollment 依赖 Session、User（关联班期和学员）
• AI 依赖 Enrollment、Course（分析用户行为和课程特征）
• Learning 依赖 Enrollment、Course（跟踪学习进度）
• Student 依赖 Learning、User（学员专属功能）
• Statistics 依赖所有业务模块（数据聚合）
• Notification 依赖 Learning（学习提醒）
```

---

## 4. 权限设计

### 4.1 角色定义

| 角色 | 标识 | 说明 |
|------|------|------|
| 管理员 | ADMIN | 系统管理，全部权限 |
| 讲师 | INSTRUCTOR | 查看分配的班期和学员 |
| 学员 | STUDENT | 浏览课程、报名、学习 |

### 4.2 权限矩阵

| 功能模块 | 管理员 | 讲师 | 学员 |
|----------|--------|------|------|
| 用户管理 | ✅ CRUD | ❌ | ❌ |
| 课程管理 | ✅ CRUD | ✅ 查看 | ✅ 查看 |
| 班期管理 | ✅ CRUD | ✅ 查看自己 | ✅ 查看 |
| 报名管理 | ✅ CRUD | ✅ 查看学员 | ✅ 自己报名 |
| 学习中心 | ❌ | ❌ | ✅ 完整功能 |
| AI 推荐 | ✅ 配置 | ❌ | ✅ 使用 |
| 统计看板 | ✅ 全部 | ✅ 自己班期 | ✅ 自己数据 |

### 4.3 接口权限控制

```java
// Spring Security 配置示例
@PreAuthorize("hasRole('ADMIN')")
public void adminOnly() {}

@PreAuthorize("hasAnyRole('ADMIN', 'INSTRUCTOR')")
public void adminOrInstructor() {}

@PreAuthorize("hasRole('STUDENT')")
public void studentOnly() {}
```

---

## 5. 关键流程

### 5.1 用户认证流程

```
┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐
│  用户   │     │  前端   │     │  后端   │     │ 数据库  │
└────┬────┘     └────┬────┘     └────┬────┘     └────┬────┘
     │               │               │               │
     │  输入账号密码  │               │               │
     │──────────────>│               │               │
     │               │  POST /login  │               │
     │               │──────────────>│               │
     │               │               │  查询用户     │
     │               │               │──────────────>│
     │               │               │  返回用户信息 │
     │               │               │<──────────────│
     │               │               │               │
     │               │               │  验证密码     │
     │               │               │  生成 JWT     │
     │               │               │               │
     │               │  返回 Token   │               │
     │               │<──────────────│               │
     │  登录成功     │               │               │
     │<──────────────│               │               │
     │               │               │               │
```

### 5.2 课程报名流程

```
┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐
│  学员   │     │  前端   │     │  后端   │     │ 数据库  │
└────┬────┘     └────┬────┘     └────┬────┘     └────┬────┘
     │               │               │               │
     │  点击报名     │               │               │
     │──────────────>│               │               │
     │               │ POST /enroll  │               │
     │               │──────────────>│               │
     │               │               │  检查名额     │
     │               │               │──────────────>│
     │               │               │  返回名额数   │
     │               │               │<──────────────│
     │               │               │               │
     │               │               │  检查重复报名 │
     │               │               │──────────────>│
     │               │               │<──────────────│
     │               │               │               │
     │               │               │  创建报名记录 │
     │               │               │  更新名额     │
     │               │               │──────────────>│
     │               │               │<──────────────│
     │               │               │               │
     │               │  报名成功     │               │
     │               │<──────────────│               │
     │  显示结果     │               │               │
     │<──────────────│               │               │
```

### 5.3 AI 推荐流程

```
┌─────────┐     ┌─────────┐     ┌─────────┐     ┌─────────┐
│  学员   │     │  后端   │     │ AI 服务 │     │ 数据库  │
└────┬────┘     └────┬────┘     └────┬────┘     └────┬────┘
     │               │               │               │
     │  请求推荐     │               │               │
     │──────────────>│               │               │
     │               │  获取用户画像 │               │
     │               │──────────────────────────────>│
     │               │<──────────────────────────────│
     │               │               │               │
     │               │  协同过滤推荐 │               │
     │               │──────────────────────────────>│
     │               │<──────────────────────────────│
     │               │               │               │
     │               │  内容推荐     │               │
     │               │──────────────>│               │
     │               │<──────────────│               │
     │               │               │               │
     │               │  混合推荐结果 │               │
     │               │  记录日志     │               │
     │               │──────────────────────────────>│
     │               │               │               │
     │  返回推荐     │               │               │
     │<──────────────│               │               │
```

---

## 6. 部署架构

### 6.1 开发环境

```
┌─────────────────────────────────────────┐
│              开发机器                    │
├─────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐       │
│  │   前端      │  │   后端      │       │
│  │  Vite Dev   │  │ Spring Boot │       │
│  │  :5173      │  │   :8080     │       │
│  └─────────────┘  └─────────────┘       │
│                                         │
│  ┌─────────────┐  ┌─────────────┐       │
│  │   MySQL     │  │   Redis     │       │
│  │   :3306     │  │   :6379     │       │
│  └─────────────┘  └─────────────┘       │
└─────────────────────────────────────────┘
```

### 6.2 Docker Compose 部署

```yaml
# docker-compose.yml
services:
  frontend:
    build: ./it-training-frontend
    ports:
      - "80:80"
    depends_on:
      - backend

  backend:
    build: ./it-training-backend
    ports:
      - "8080:8080"
    environment:
      - SPRING_PROFILES_ACTIVE=prod
    depends_on:
      - mysql
      - redis

  mysql:
    image: mysql:8.0
    volumes:
      - mysql_data:/var/lib/mysql

  redis:
    image: redis:7-alpine
    volumes:
      - redis_data:/data

volumes:
  mysql_data:
  redis_data:
```

### 6.3 生产环境建议

```
┌─────────────────────────────────────────────────────────────┐
│                        负载均衡                              │
│                      (Nginx/ALB)                            │
└─────────────────────────┬───────────────────────────────────┘
                          │
          ┌───────────────┼───────────────┐
          │               │               │
          ▼               ▼               ▼
    ┌──────────┐   ┌──────────┐   ┌──────────┐
    │ 前端容器 │   │ 前端容器 │   │ 前端容器 │
    └──────────┘   └──────────┘   └──────────┘
          │               │               │
          └───────────────┼───────────────┘
                          │
                          ▼
    ┌──────────┐   ┌──────────┐   ┌──────────┐
    │ 后端容器 │   │ 后端容器 │   │ 后端容器 │
    └──────────┘   └──────────┘   └──────────┘
          │               │               │
          └───────────────┼───────────────┘
                          │
          ┌───────────────┼───────────────┐
          │               │               │
          ▼               ▼               ▼
    ┌──────────┐   ┌──────────┐   ┌──────────┐
    │  MySQL   │   │  Redis   │   │  AI API  │
    │  主从    │   │  集群    │   │  外部    │
    └──────────┘   └──────────┘   └──────────┘
```

---

## 7. 参考风格说明

### 7.1 代码规范

- 后端遵循阿里巴巴 Java 开发手册
- 前端遵循 Vue 3 官方风格指南
- 使用 ESLint + Prettier 统一代码风格

### 7.2 API 设计规范

- RESTful 风格
- 统一响应格式：`{ code, message, data }`
- 错误码规范：见 [api.md](../03-API/api.md)

### 7.3 数据库规范

- 表名小写下划线
- 主键统一使用 `id`
- 必备字段：`create_time`, `update_time`, `delete_flag`

---

> 文档维护：架构变更时同步更新本文档
